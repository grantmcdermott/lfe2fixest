<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="What the package does (one paragraph).">
<title>Converts `lfe::felm()` To The `fixest::feols()` Equivalents • lfe2fixest</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Converts `lfe::felm()` To The `fixest::feols()` Equivalents">
<meta property="og:description" content="What the package does (one paragraph).">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">lfe2fixest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/grantmcdermott/lfe2fixest/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="lfe2fixest">lfe2fixest<a class="anchor" aria-label="anchor" href="#lfe2fixest"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p><a href="#motivation"><code>Motivation</code></a> <a href="#installation"><code>Installation</code></a> <a href="#example"><code>Example</code></a> <a href="#caveats"><code>Caveats</code></a></p>
<div class="section level2">
<h2 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h2>
<p>The goal of <strong>lfe2fixest</strong> is to take R scripts that rely on the <code>felm()</code> function from the <a href="https://github.com/sgaure/lfe" class="external-link"><strong>lfe</strong></a> package and convert them to their <code>feols()</code> equivalents from the <a href="https://lrberge.github.io/fixest" class="external-link"><strong>fixest</strong></a> package.</p>
<p>Why would you want to do this?</p>
<p>Both <code><a href="https://rdrr.io/pkg/lfe/man/felm.html" class="external-link">lfe::felm()</a></code> and <code><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">fixest::feols()</a></code> provide “fixed-effects” estimation routines for high-dimensional data. Both methods are also highly optimised. However, <code>feols()</code> is newer, tends to be significantly faster, and allows for additional functionality (e.g. a <code>predict</code> method). At the same time, the primary author of <strong>lfe</strong> has stopped developing the package. It has since been adopted, but is essentially in pure maintenance mode.</p>
<p>The syntax between <code>felm()</code> and <code>feols()</code> is similar, albeit with one not necessarily providing a drop-in replacement for the other. For example, the following two lines of code are functionally equivalent versions of the same underlying model.<sup id="a1"><a href="#f1">1</a></sup></p>
<ul>
<li><code>felm(y ~ x1 + x2 | fe1 + fe2 | (x3 | x4 ~ z1 + z2) | cl1, data = dat)</code></li>
<li><code>feols(y ~ x1 + x2 | fe1 + fe2 | c(x3, x4) ~ z1 + z2, cluster = ~cl1, data = dat)</code></li>
</ul>
<p>The <strong>lfe2fixest</strong> package automates the translation between these kinds of models. It does its best to ignoring any non-relevant arguments and adjust for differing syntax options between <code>felm()</code> and <code>feols()</code>. The end goal is a converted R script that will produce exactly the same output, some minor <a href="#caveats">caveats</a> notwithstanding.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the package directly from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("remotes")</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"grantmcdermott/lfe2fixest"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>Start by loading this package. Note the example scripts that follow assume you have both <em>lfe</em> and <strong>fixest</strong>, as well as <strong>modelsummary</strong> installed on your system.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/grantmcdermott/lfe2fixest" class="external-link">lfe2fixest</a></span><span class="op">)</span> <span class="co">## This package</span>

<span class="co">## Aside: Make sure you have the following packages installed on your system if</span>
<span class="co">## you want to run the example scripts below:</span>
<span class="co">## library(lfe); library(fixest); library(modelsummary)</span></code></pre></div>
<p>Let’s create an <strong>lfe</strong>-based R script, that’s deliberately messy to pose an additional challenge (inconsistent formatting, etc.)</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lfe_string</span> <span class="op">=</span> <span class="st">[1063 chars quoted with '"']</span>
<span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">lfe_string</span>, <span class="st">'lfe_script.R'</span><span class="op">)</span></code></pre></div>
<p>We can now convert this script to the <strong>fixest</strong> equivalent using the package’s main function, <code><a href="reference/lfe2fixest.html">lfe2fixest()</a></code>, or its alias, <code><a href="reference/lfe2fixest.html">felm2feols()</a></code>. While the function(s) accept several arguments, the only required argument is an input file. Similarly, if no output file argument is provided, then the function(s) will just print the conversion results to screen.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># felm2feols('lfe_script.R') ## same thing</span>
<span class="fu"><a href="reference/lfe2fixest.html">lfe2fixest</a></span><span class="op">(</span><span class="st">'lfe_script.R'</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; library(fixest)</span>
<span class="co">#&gt; library(modelsummary)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ## Our toy dataset</span>
<span class="co">#&gt; aq = airquality</span>
<span class="co">#&gt; names(aq) = c('y', 'x1', 'x2', 'x3', 'mnth', 'dy')</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ## Simple OLS (no FEs)</span>
<span class="co">#&gt; mod1 = feols(y ~ x1 + x2,  data = aq)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ## Add a FE and cluster variable</span>
<span class="co">#&gt; mod2 = feols(y ~ x1 + x2 | dy, cluster = ~mnth,  data = aq)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ## Add a second cluster variable and some estimation options</span>
<span class="co">#&gt; mod3 = feols(y ~ x1 + x2 | dy, cluster = ~dy + mnth,  data =</span>
<span class="co">#&gt;             aq)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ## IV reg with weights</span>
<span class="co">#&gt; mod4 = feols(y ~ 1 | dy | x1 ~ x3, cluster = ~mnth, weights = aq$x2, data = aq )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ## Multiple IV</span>
<span class="co">#&gt; mod5 = feols(y ~ 1 | x1 + x2 ~ x3 + dy + mnth, cluster = ~dy, data = aq )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ## Regression table</span>
<span class="co">#&gt; mods = list(mod1, mod2, mod3, mod4, mod5)</span>
<span class="co">#&gt; msummary(mods, gof_omit = 'Pseudo|Within|Log|IC', output = 'markdown')</span></code></pre></div>
<p>Looks good. Note that the <code>feols</code> (<code>felm</code>) model syntax has been cleaned up, with comments removed and everything collapsed onto a single line.<sup id="a2"><a href="#f2">2</a></sup> Let’s write it to disk by supplying an output file this time.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># felm2feols(infile = 'lfe_script.R', outfile = 'fixest_script.R') ## same thing</span>
<span class="fu"><a href="reference/lfe2fixest.html">lfe2fixest</a></span><span class="op">(</span>infile <span class="op">=</span> <span class="st">'lfe_script.R'</span>, outfile <span class="op">=</span> <span class="st">'fixest_script.R'</span><span class="op">)</span></code></pre></div>
<p>Note that the <code><a href="reference/lfe2fixest.html">lfe2fixest()</a></code> is a pure conversion function. It never actually runs anything from either the input or output files. That being said, here’s a quick comparison of the resulting regressions — i.e. what we get if we actually <em>do</em> run the scripts. As an aside, my scripts make use of the excellent <a href="https://vincentarelbundock.github.io/modelsummary/index.html" class="external-link"><strong>modelsummary</strong></a> package to generate the simple regression tables that you see below, although we’re really not showing off its functionality here.</p>
<p>First, the original <strong>lfe</strong> version:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">'lfe_script.R'</span>, print.eval <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; |            | Model 1 | Model 2  |    Model 3    | Model 4  | Model 5  |</span>
<span class="co">#&gt; |:-----------|:-------:|:--------:|:-------------:|:--------:|:--------:|</span>
<span class="co">#&gt; |(Intercept) | 77.246  |          |               |          |  93.452  |</span>
<span class="co">#&gt; |            | (9.068) |          |               |          | (65.757) |</span>
<span class="co">#&gt; |x1          |  0.100  |  0.099   |     0.099     |          |          |</span>
<span class="co">#&gt; |            | (0.026) | (0.031)  |    (0.029)    |          |          |</span>
<span class="co">#&gt; |x2          | -5.402  |  -5.577  |    -5.577     |          |          |</span>
<span class="co">#&gt; |            | (0.673) | (1.100)  |    (1.053)    |          |          |</span>
<span class="co">#&gt; |`x1(fit)`   |         |          |               |  0.733   |  0.236   |</span>
<span class="co">#&gt; |            |         |          |               | (0.254)  | (0.179)  |</span>
<span class="co">#&gt; |`x2(fit)`   |         |          |               |          |  -9.558  |</span>
<span class="co">#&gt; |            |         |          |               |          | (3.510)  |</span>
<span class="co">#&gt; |Num.Obs.    |   111   |   111    |      111      |   111    |   111    |</span>
<span class="co">#&gt; |R2          |  0.449  |  0.665   |     0.665     |  -2.658  |  0.071   |</span>
<span class="co">#&gt; |R2 Adj.     |  0.439  |  0.527   |     0.527     |  -4.093  |  0.054   |</span>
<span class="co">#&gt; |Std.Errors  |         | by: mnth | by: dy &amp; mnth | by: mnth |  by: dy  |</span></code></pre></div>
<p>Second, the <strong>fixest</strong> conversion:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">'fixest_script.R'</span>, print.eval <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; |            | Model 1 | Model 2  |    Model 3    | Model 4  | Model 5  |</span>
<span class="co">#&gt; |:-----------|:-------:|:--------:|:-------------:|:--------:|:--------:|</span>
<span class="co">#&gt; |(Intercept) | 77.246  |          |               |          |  93.452  |</span>
<span class="co">#&gt; |            | (9.068) |          |               |          | (65.757) |</span>
<span class="co">#&gt; |x1          |  0.100  |  0.099   |     0.099     |          |          |</span>
<span class="co">#&gt; |            | (0.026) | (0.031)  |    (0.029)    |          |          |</span>
<span class="co">#&gt; |x2          | -5.402  |  -5.577  |    -5.577     |          |          |</span>
<span class="co">#&gt; |            | (0.673) | (1.100)  |    (1.053)    |          |          |</span>
<span class="co">#&gt; |fit_x1      |         |          |               |  0.733   |  0.236   |</span>
<span class="co">#&gt; |            |         |          |               | (0.254)  | (0.179)  |</span>
<span class="co">#&gt; |fit_x2      |         |          |               |          |  -9.558  |</span>
<span class="co">#&gt; |            |         |          |               |          | (3.510)  |</span>
<span class="co">#&gt; |Num.Obs.    |   111   |   111    |      111      |   111    |   111    |</span>
<span class="co">#&gt; |R2          |  0.449  |  0.665   |     0.665     |  -2.658  |  0.071   |</span>
<span class="co">#&gt; |R2 Adj.     |  0.439  |  0.527   |     0.527     |  -4.093  |  0.054   |</span>
<span class="co">#&gt; |Std.Errors  |   IID   | by: mnth | by: dy &amp; mnth | by: mnth |  by: dy  |</span>
<span class="co">#&gt; |FE: dy      |         |    X     |       X       |    X     |          |</span></code></pre></div>
<p>Some minor formatting differences aside, looks like it worked and we get the exact same results from both scripts. Great!</p>
<p>Let’s clean up before closing.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lfe_script.R'</span>, <span class="st">'fixest_script.R'</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE TRUE</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="caveats">Caveats<a class="anchor" aria-label="anchor" href="#caveats"></a>
</h2>
<p>While I’m confident that <strong>lfe2fixest</strong> will work out-of-the-box in most (9 out of 10?) situations, there are some minor caveats to bear in mind.</p>
<ul>
<li>
<code>feols()</code> offers a variety of optimised features and syntax for things like <a href="https://cran.r-project.org/web/packages/fixest/vignettes/fixest_walkthrough.html#31_Varying_slopes" class="external-link">varying slopes</a>, <a href="https://cran.r-project.org/web/packages/fixest/vignettes/multiple_estimations.html" class="external-link">multiple estimation</a>, etc. that go beyond the standard R syntax (although the latter still works). <strong>lfe2fixest</strong> doesn’t try to exploit any of these specialised features. It’s more or less a literal translation of the <code>felm()</code> formula. The goal is to get you up and running with as little pain as possible, rather than eking every extra bit out of <code>feols()</code>’s already eye-watering performance.</li>
<li>Similarly, because <code>felm()</code> and <code>feols()</code> do not share all of the same arguments, there are cases where the conversion can yield different results. An example would be in the case of multiway clustering where the <code>felm()</code> call does not specify the right <code>cmethod</code> option. (More <a href="https://github.com/sgaure/lfe/pull/26" class="external-link">here</a> and <a href="https://cran.r-project.org/web/packages/fixest/vignettes/standard_errors.html" class="external-link">here</a>.)</li>
<li>The conversion only handles (or attempts to handle) the actual model calls. No attempt is made to convert downstream objects or functions like regression table construction. Although, as demonstrated in the example, you should be okay if you use a modern table-generating package like <strong>modelsummary</strong>. But the same would not be true of <strong>stargazer</strong>, for example.</li>
<li>I assume that users always provide a dataset in their model calls (i.e.  regressions with global variables are not supported).</li>
<li>Similarly, the package only supports models that are explicitly written out in a script. If your models are constructed programatically (e.g. with <code>Formula()</code>) then the conversion probably won’t work.</li>
</ul>
<p><sup><b id="f1">1</b></sup> An IV regression with multiple endogenous variables and fixed effects, as well as clustered standard errors. But that’s besides the point.<a href="#a1">↩︎</a></p>
<p><sup><b id="f2">2</b></sup> The loss of inline comments is a little unfortunate, but necessary given the way that the function parses input.<a href="#a2">↩︎</a></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/grantmcdermott/lfe2fixest/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/grantmcdermott/lfe2fixest/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing lfe2fixest</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Grant McDermott <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-7883-8573" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Grant McDermott.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
